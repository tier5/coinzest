<script>

	  app.controller('PageController', ['$scope', '$http', '$window', function($scope, $http, $window) {

		var vm = this;
		vm.arr_data = [];

		vm.search = "";
	
		
		var data = [];

		data['human_name'] = "Daily Tasks";
		data['name'] = "daily_tasks";
		vm.arr_data[vm.arr_data.length] = data;

		data = [];
		data['human_name'] = "Support";
		data['name'] = "support";
		vm.arr_data[vm.arr_data.length] = data;

		data = [];
		data['human_name'] = "Letters of Happiness";
		data['name'] = "loh";
		vm.arr_data[vm.arr_data.length] = data;


		/*
		$http({
		    method: 'POST',
		    url: '/platform/membersadmin/get_data/',
			data: { search: vm.search }
		}).success(function (result) {
			if (result.is_success) {
				//vm.arr_data = result.arr_data;
				
			}
		});
		*/


		$scope.edit_click = function(name) {
			$window.location = "/platform/sitecontents/edit/" + name;
			
		};

		$scope.delete_click = function(index) {
			var result = $window.confirm('Are you sure you want to delete?');
                        if (result) {
                                $http({
                                    method: 'get',
                                    url: '/segments/delete/' + index,
                                }).success(function (result) {
                                        $window.location = "/segments";
                                });
                        }
		};

	}]);

</script>

<style>

	.table_header {
		font-weight:900;
	}
	td {
		padding-left:10px;
		padding-right:10px;
	}

	.data_table_odd_cell {

		background-color: #f8f8f8;
		border-bottom:1px solid  #d8d8d8;
		padding-top:13px;
		padding-bottom:13px;
	}


	.data_table_even_cell {
		background-color: #ffffff;
		border-bottom:1px solid  #d8d8d8;
		padding-top:13px;
		padding-bottom:13px;
	}

	.data_table > tr:hover > td {
		background-color: #ffff99;
	}

	tr.have_hover:hover > td {
		background-color: #add8e6;
	}

	td.clickable:hover {
		cursor:pointer;
	}

	th {
		padding-left:10px !important;
		padding-right:10px !important;
	}
</style>
<div class="page-title-header">
	Daily Tasks
</div>

<div ng-controller="PageController as page_ctrl">

	<div style="clear:both;"></div>


<div class="flex_container">
	<div>
		<?=$t->contents_html?>
		<?php 
			$var = $_SESSION;
			$id = $var['user_id'];
		?>
	</div>
</div>


</div>
<script type="text/javascript">
	$(function(){
		var userid = <?php echo $id;?>;
		//console.log(userid);
		var task_one_jq = "";
		var task_two_jq = "";
		var progress = 0;
		$.ajax({
      		url: "/platform/GetSheetData",
      		type: "POST",
      		data:{userid:userid},
      		success: function(response) {
	      		switch(response) {
	      			case "No Id":
	      				console.log("No user id found!");
	      			break;
	      			case "No Data Related To user id":
	      				console.log("No Data Related To user id!");
	      			break;
	      			case "No Data in spread sheet":
	      				console.log("No Data in spread sheet!");
	      			break;
	      			default:
	      				var response = $.parseJSON(response);
	      				if (response.length > 0) {
		      				for(var i =0; i < response.length; i++){
		      					task_one_jq = response[i].task_one;
		      					task_one_jq = task_one_jq == 1 ? "DONE" : "Pending or rejected";
		      					task_two_jq = response[i].task_two;
		      					task_two_jq = task_two_jq == 1 ? "DONE" : "Pending or rejected";
		      					progress += parseFloat(response[i].task_one == 1 ? 3.33 : 0);
		      					progress += parseFloat(response[i].task_two == 1 ? 3.33 : 0);
				      			$('#show_data').append('<tr><td>'+response[i].update_date+'</td><td>'+response[i].name+'</td><td>'+response[i].bmh_user_id+'</td><td>'+task_one_jq+'</td><td>'+response[i].modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response[i].modarator_comment_task_two+'</td></tr>');
				      		}
				      		progress = progress.toFixed(2);
				      		console.log(progress);
				      		_generateProgress(progress);
	      				} else {
	      					console.log("Some internal error occured! debug defult case");
	      				}
	      			break;
	      		}
      		}
      	});
	});
	function _generateProgress(value) {
		//progress bar 
		$('.progress .progress-bar').css("width",function() {
			$(this).attr("aria-valuenow", value);
			$('.val').text(value+"%");
	        return $(this).attr("aria-valuenow") + "%";
	    });
	}
</script>
