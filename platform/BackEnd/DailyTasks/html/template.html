<script>

	  app.controller('PageController', ['$scope', '$http', '$window', function($scope, $http, $window) {

		var vm = this;
		vm.arr_data = [];

		vm.search = "";
	
		
		var data = [];

		data['human_name'] = "Daily Tasks";
		data['name'] = "daily_tasks";
		vm.arr_data[vm.arr_data.length] = data;

		data = [];
		data['human_name'] = "Support";
		data['name'] = "support";
		vm.arr_data[vm.arr_data.length] = data;

		data = [];
		data['human_name'] = "Letters of Happiness";
		data['name'] = "loh";
		vm.arr_data[vm.arr_data.length] = data;


		/*
		$http({
		    method: 'POST',
		    url: '/platform/membersadmin/get_data/',
			data: { search: vm.search }
		}).success(function (result) {
			if (result.is_success) {
				//vm.arr_data = result.arr_data;
				
			}
		});
		*/


		$scope.edit_click = function(name) {
			$window.location = "/platform/sitecontents/edit/" + name;
			
		};

		$scope.delete_click = function(index) {
			var result = $window.confirm('Are you sure you want to delete?');
                        if (result) {
                                $http({
                                    method: 'get',
                                    url: '/segments/delete/' + index,
                                }).success(function (result) {
                                        $window.location = "/segments";
                                });
                        }
		};

	}]);

</script>

<style>

	.table_header {
		font-weight:900;
	}
	td {
		padding-left:10px;
		padding-right:10px;
	}

	.data_table_odd_cell {

		background-color: #f8f8f8;
		border-bottom:1px solid  #d8d8d8;
		padding-top:13px;
		padding-bottom:13px;
	}


	.data_table_even_cell {
		background-color: #ffffff;
		border-bottom:1px solid  #d8d8d8;
		padding-top:13px;
		padding-bottom:13px;
	}

	.data_table > tr:hover > td {
		background-color: #ffff99;
	}

	tr.have_hover:hover > td {
		background-color: #add8e6;
	}

	td.clickable:hover {
		cursor:pointer;
	}

	th {
		padding-left:10px !important;
		padding-right:10px !important;
	}
</style>
<div class="page-title-header">
	Daily Tasks
</div>

<div ng-controller="PageController as page_ctrl">

	<div style="clear:both;"></div>


<div class="flex_container">
	<div>
		<?=$t->contents_html?>
		<?php 
			$var = $_SESSION;
			$id = $var['user_id'];
		?>
	</div>
</div>


</div>
<script type="text/javascript">
	$(function(){
		//get current month and highlight that table
		var month  = _returnMonth();
		//var progress = 0;
		var userid = <?php echo $id;?>;
		$.ajax({
      		url: "/platform/GetSheetData",
      		type: "POST",
      		data:{userid:userid},
      		success: function(response) {
	      		switch(response) {
	      			case "No Id":
	      				console.log("No user id found!");
	      			break;
	      			case "No Data Related To user id":
	      				console.log("No Data Related To user id!");
	      			break;
	      			case "No Data in spread sheet":
	      				console.log("No Data in spread sheet!");
	      			break;
	      			default:
	      				var response = $.parseJSON(response);
	      				//console.log(response);
	      				//return;
	      				if (response.length > 0) {

		      				for(var i =0; i < response.length; i++){
		      					//progress += parseFloat(response[i].modarator_comment_task_one == '3.33 % Earned' ? 3.33 : 0);
								//progress += parseFloat(response[i].modarator_comment_task_two == '3.33 % Earned' ? 3.33 : 0);
		      					_showTableData(response[i].update_date.split('-')[1], response[i]);
				      		}
				      		//progress = progress.toFixed(2);
							//_generateProgress(progress, month);
	      				} else {
	      					console.log("Some internal error occured! debug defult case");
	      				}
	      			break;
	      		}
      		}
      	});
	});
	function _generateProgress(response, month) {
		//progress bar 
		var month = parseInt(month);
		var progress = 0.00;
		switch(month) {
			case 1:
				
				progress += response.modarator_comment_task_one == '3.33 % Earned' ? 3.33 : 0;
				progress += response.modarator_comment_task_two == '3.33 % Earned' ? 3.33 : 0;
				return progress; 
			break;
			case 2:
				//var progress = 0.00;
				progress += response.modarator_comment_task_one == '3.33 % Earned' ? 3.33 : 0;
				progress += response.modarator_comment_task_two == '3.33 % Earned' ? 3.33 : 0;
				return progress;
			break;
			case 3:
				//var progress = 0.00;
				progress += response.modarator_comment_task_one == '3.33 % Earned' ? 3.33 : 0;
				progress += response.modarator_comment_task_two == '3.33 % Earned' ? 3.33 : 0;
				return progress;
			break;
			case 4:
				//var progress = 0.00;
				progress += response.modarator_comment_task_one == '3.33 % Earned' ? 3.33 : 0;
				progress += response.modarator_comment_task_two == '3.33 % Earned' ? 3.33 : 0;
				return progress;
			break;
			case 5:
				//var progress = 0.00;
				progress += response.modarator_comment_task_one == '3.33 % Earned' ? 3.33 : 0;
				progress += response.modarator_comment_task_two == '3.33 % Earned' ? 3.33 : 0;
				return progress;
			break;
			case 6:
				//var progress = 0.00;
				progress += response.modarator_comment_task_one == '3.33 % Earned' ? 3.33 : 0;
				progress += response.modarator_comment_task_two == '3.33 % Earned' ? 3.33 : 0;
				return progress;
			break;
			case 7:
				//var progress = 0.00;
				progress += response.modarator_comment_task_one == '3.33 % Earned' ? 3.33 : 0;
				progress += response.modarator_comment_task_two == '3.33 % Earned' ? 3.33 : 0;
				return progress;
			break;
			case 8:
				//var progress = 0.00;
				progress += response.modarator_comment_task_one == '3.33 % Earned' ? 3.33 : 0;
				progress += response.modarator_comment_task_two == '3.33 % Earned' ? 3.33 : 0;
				return progress;
			break;
			case 9:
				//var progress = 0.00;
				progress += response.modarator_comment_task_one == '3.33 % Earned' ? 3.33 : 0;
				progress += response.modarator_comment_task_two == '3.33 % Earned' ? 3.33 : 0;
				return progress;
			break;
			case 10:
				//var progress = 0.00;
				progress += response.modarator_comment_task_one == '3.33 % Earned' ? 3.33 : 0;
				progress += response.modarator_comment_task_two == '3.33 % Earned' ? 3.33 : 0;
				return progress;
			break;
			case 11:
				//var progress = 0.00;
				progress += response.modarator_comment_task_one == '3.33 % Earned' ? 3.33 : 0;
				progress += response.modarator_comment_task_two == '3.33 % Earned' ? 3.33 : 0;
				return progress;
			break;
			case 12:
				var progress = 0.00;
				progress += response.modarator_comment_task_one == '3.33 % Earned' ? 3.33 : 0;
				progress += response.modarator_comment_task_two == '3.33 % Earned' ? 3.33 : 0;
				return progress;
			break;
			default:
				console.log('Error in selecting the month debug in generate progress');
			break;
		}
	}
	function _returnMonth() {
		var month = moment().month();
		month = month+1;
		//console.log(month);
		switch(month) {
			case 1:
				$('#tab_jan').parent().attr('style','border:5px solid #00acb3;');
				return 1;
			break;
			case 2:
				$('#tab_feb').parent().attr('style','border:5px solid #00acb3;');
				return 2;
			break;
			case 3:
				$('#tab_mar').parent().attr('style','border:5px solid #00acb3;');
				return 3;
			break;
			case 4:
				$('#tab_apr').parent().attr('style','border:5px solid #00acb3;');
				return 4;
			break;
			case 5:
				$('#tab_may').parent().attr('style','border:5px solid #00acb3;');
				return 5;
			break;
			case 6:
				$('#tab_jun').parent().attr('style','border:5px solid #00acb3;');
				return 6;
			break;
			case 7:
				$('#tab_july').parent().attr('style','border:5px solid #00acb3;');
				return 7;
			break;
			case 8:
				$('#tab_aug').parent().attr('style','border:5px solid #00acb3;');
				return 8;
			break;
			case 9:
				$('#tab_sep').parent().attr('style','border:5px solid #00acb3;');
				return 9;
			break;
			case 10:
				$('#tab_oct').parent().attr('style','border:5px solid #00acb3;');
				return 10;
			break;
			case 11:
				$('#tab_nov').parent().attr('style','border:5px solid #00acb3;');
				return 11;
			break;
			case 12:
				$('#tab_dec').parent().attr('style','border:5px solid #00acb3;');
				return 12;
			break;
			default:
				console.log('Error in selecting the month debug in return month');
			break;
		}
	}
	function _showTableData(month, response) {
		var month = parseInt(month);
		var progressData = 0.00;
		var previousValue = 0.00;
		var newValue = 0.00;
		var task_one_jq = "";
		var task_two_jq = "";
		task_one_jq = response.task_one;
		task_one_jq = task_one_jq == 1 ? "DONE" : "Pending or rejected";
		task_two_jq = response.task_two;
		task_two_jq = task_two_jq == 1 ? "DONE" : "Pending or rejected";
		switch(month) {
			case 1:
			progressData = _generateProgress(response, 1);
				previousValue = $('.prog_jan .val').text();
				console.log(previousValue);
				progressData = parseFloat(progressData);
				previousValue = parseFloat(previousValue);
				newValue = previousValue+progressData;
				$('.progress .prog_jan').css("width",function(){
					$(this).attr("aria-valuenow", newValue);
					$('.val').text(newValue+"%");
			        return $(this).attr("aria-valuenow") + "%";
			    });
			$('#tab_jan #show_data').append('<tr><td>'+response.update_date+'</td><td>'+response.name+'</td><td>'+response.bmh_user_id+'</td><td>'+task_one_jq+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 2:
			progressData = _generateProgress(response, 2);
				previousValue = $('.prog_feb .val').text();
				console.log(previousValue);
				progressData = parseFloat(progressData);
				previousValue = parseFloat(previousValue);
				newValue = previousValue+progressData;
				$('.progress .prog_feb').css("width",function(){
					$(this).attr("aria-valuenow", newValue);
					$('.val').text(newValue+"%");
			        return $(this).attr("aria-valuenow") + "%";
			    });
				$('#tab_feb #show_data').append('<tr><td>'+response.update_date+'</td><td>'+response.name+'</td><td>'+response.bmh_user_id+'</td><td>'+task_one_jq+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 3:
			progressData = _generateProgress(response, 3);
				previousValue = $('.prog_mar .val').text();
				console.log(previousValue);
				progressData = parseFloat(progressData);
				previousValue = parseFloat(previousValue);
				newValue = previousValue+progressData;
				$('.progress .prog_mar').css("width",function(){
					$(this).attr("aria-valuenow", newValue);
					$('.val').text(newValue+"%");
			        return $(this).attr("aria-valuenow") + "%";
			    });
				$('#tab_mar #show_data').append('<tr><td>'+response.update_date+'</td><td>'+response.name+'</td><td>'+response.bmh_user_id+'</td><td>'+task_one_jq+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 4:
			progressData = _generateProgress(response, 4);
				previousValue = $('.prog_apr .val').text();
				console.log(previousValue);
				progressData = parseFloat(progressData);
				previousValue = parseFloat(previousValue);
				newValue = previousValue+progressData;
				$('.progress .prog_apr').css("width",function(){
					$(this).attr("aria-valuenow", newValue);
					$('.val').text(newValue+"%");
			        return $(this).attr("aria-valuenow") + "%";
			    });
				$('#tab_apr #show_data').append('<tr><td>'+response.update_date+'</td><td>'+response.name+'</td><td>'+response.bmh_user_id+'</td><td>'+task_one_jq+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 5:
				progressData = _generateProgress(response, 5);
				previousValue = $('.prog_may .val').text();
				console.log(previousValue);
				progressData = parseFloat(progressData);
				previousValue = parseFloat(previousValue);
				newValue = previousValue+progressData;
				$('.progress .prog_may').css("width",function(){
					$(this).attr("aria-valuenow", newValue);
					$('.val').text(newValue+"%");
			        return $(this).attr("aria-valuenow") + "%";
			    });
				$('#tab_may #show_data').append('<tr><td>'+response.update_date+'</td><td>'+response.name+'</td><td>'+response.bmh_user_id+'</td><td>'+task_one_jq+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 6:
				progressData = _generateProgress(response, 6);
				previousValue = $('.prog_jun .val').text();
				console.log(previousValue);
				progressData = parseFloat(progressData);
				previousValue = parseFloat(previousValue);
				newValue = previousValue+progressData;
				$('.progress .prog_jun').css("width",function(){
					$(this).attr("aria-valuenow", newValue);
					$('.val').text(newValue+"%");
			        return $(this).attr("aria-valuenow") + "%";
			    });
				$('#tab_jun #show_data').append('<tr><td>'+response.update_date+'</td><td>'+response.name+'</td><td>'+response.bmh_user_id+'</td><td>'+task_one_jq+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 7:
				progressData = _generateProgress(response, 7);
				previousValue = $('.prog_july .val').text();
				console.log(previousValue);
				progressData = parseFloat(progressData);
				previousValue = parseFloat(previousValue);
				newValue = previousValue+progressData;
				$('.progress .prog_july').css("width",function(){
					$(this).attr("aria-valuenow", newValue);
					$('.val').text(newValue+"%");
			        return $(this).attr("aria-valuenow") + "%";
			    });
				$('#tab_july #show_data').append('<tr><td>'+response.update_date+'</td><td>'+response.name+'</td><td>'+response.bmh_user_id+'</td><td>'+task_one_jq+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 8:
				progressData = _generateProgress(response, 8);
				previousValue = $('.prog_aug .val').text();
				console.log(previousValue);
				progressData = parseFloat(progressData);
				previousValue = parseFloat(previousValue);
				newValue = previousValue+progressData;
				$('.progress .prog_aug').css("width",function(){
					$(this).attr("aria-valuenow", newValue);
					$('.val').text(newValue+"%");
			        return $(this).attr("aria-valuenow") + "%";
			    });
				$('#tab_aug #show_data').append('<tr><td>'+response.update_date+'</td><td>'+response.name+'</td><td>'+response.bmh_user_id+'</td><td>'+task_one_jq+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 9:
				progressData = _generateProgress(response, 9);
				previousValue = $('.prog_sep .val').text();
				console.log(previousValue);
				progressData = parseFloat(progressData);
				previousValue = parseFloat(previousValue);
				newValue = previousValue+progressData;
				$('.progress .prog_sep').css("width",function(){
					$(this).attr("aria-valuenow", newValue);
					$('.val').text(newValue+"%");
			        return $(this).attr("aria-valuenow") + "%";
			    });
				$('#tab_sep #show_data').append('<tr><td>'+response.update_date+'</td><td>'+response.name+'</td><td>'+response.bmh_user_id+'</td><td>'+task_one_jq+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 10:
				progressData = _generateProgress(response, 10);
				previousValue = $('.prog_oct .val').text();
				console.log(previousValue);
				progressData = parseFloat(progressData);
				previousValue = parseFloat(previousValue);
				newValue = previousValue+progressData;
				$('.progress .prog_oct').css("width",function(){
					$(this).attr("aria-valuenow", newValue);
					$('.val').text(newValue+"%");
			        return $(this).attr("aria-valuenow") + "%";
			    });
				$('#tab_oct #show_data').append('<tr><td>'+response.update_date+'</td><td>'+response.name+'</td><td>'+response.bmh_user_id+'</td><td>'+task_one_jq+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 11:
				progressData = _generateProgress(response, 11);
				previousValue = $('.prog_nov .val').text();
				console.log(previousValue);
				progressData = parseFloat(progressData);
				previousValue = parseFloat(previousValue);
				newValue = previousValue+progressData;
				$('.progress .prog_nov').css("width",function(){
					$(this).attr("aria-valuenow", newValue);
					$('.val').text(newValue+"%");
			        return $(this).attr("aria-valuenow") + "%";
			    });
				$('#tab_nov #show_data').append('<tr><td>'+response.update_date+'</td><td>'+response.name+'</td><td>'+response.bmh_user_id+'</td><td>'+task_one_jq+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 12:
				progressData = _generateProgress(response, 12);
				previousValue = $('.prog_dec .val').text();
				console.log(previousValue);
				progressData = parseFloat(progressData);
				previousValue = parseFloat(previousValue);
				newValue = previousValue+progressData;
				$('.progress .prog_dec').css("width",function(){
					$(this).attr("aria-valuenow", newValue);
					$('.val').text(newValue+"%");
			        return $(this).attr("aria-valuenow") + "%";
			    });
				$('#tab_dec #show_data').append('<tr><td>'+response.update_date+'</td><td>'+response.name+'</td><td>'+response.bmh_user_id+'</td><td>'+task_one_jq+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			default:
				console.log('Error in putting data');
			break;
		}
	}
</script>
