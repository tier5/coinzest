<script>

	  app.controller('PageController', ['$scope', '$http', '$window', function($scope, $http, $window) {

		var vm = this;
		vm.arr_data = [];

		vm.search = "";
	
		
		var data = [];

		data['human_name'] = "Daily Tasks";
		data['name'] = "daily_tasks";
		vm.arr_data[vm.arr_data.length] = data;

		data = [];
		data['human_name'] = "Support";
		data['name'] = "support";
		vm.arr_data[vm.arr_data.length] = data;

		data = [];
		data['human_name'] = "Letters of Happiness";
		data['name'] = "loh";
		vm.arr_data[vm.arr_data.length] = data;


		/*
		$http({
		    method: 'POST',
		    url: '/platform/membersadmin/get_data/',
			data: { search: vm.search }
		}).success(function (result) {
			if (result.is_success) {
				//vm.arr_data = result.arr_data;
				
			}
		});
		*/


		$scope.edit_click = function(name) {
			$window.location = "/platform/sitecontents/edit/" + name;
			
		};

		$scope.delete_click = function(index) {
			var result = $window.confirm('Are you sure you want to delete?');
                        if (result) {
                                $http({
                                    method: 'get',
                                    url: '/segments/delete/' + index,
                                }).success(function (result) {
                                        $window.location = "/segments";
                                });
                        }
		};

	}]);

</script>

<style>

	.table_header {
		font-weight:900;
	}
	td {
		padding-left:10px;
		padding-right:10px;
	}

	.data_table_odd_cell {

		background-color: #f8f8f8;
		border-bottom:1px solid  #d8d8d8;
		padding-top:13px;
		padding-bottom:13px;
	}


	.data_table_even_cell {
		background-color: #ffffff;
		border-bottom:1px solid  #d8d8d8;
		padding-top:13px;
		padding-bottom:13px;
	}

	.data_table > tr:hover > td {
		background-color: #ffff99;
	}

	tr.have_hover:hover > td {
		background-color: #add8e6;
	}

	td.clickable:hover {
		cursor:pointer;
	}

	th {
		padding-left:10px !important;
		padding-right:10px !important;
	}
</style>
<div class="page-title-header">
	Daily Tasks
</div>

<div ng-controller="PageController as page_ctrl">

	<div style="clear:both;"></div>


<div class="flex_container">
	<div>
		<?=$t->contents_html?>
		<?php 
			$var = $_SESSION;
			$id = $var['user_id'];
		?>
	</div>
</div>


</div>
<script type="text/javascript">
	$(function(){
		//get current month and highlight that table
		setter_1 = 0;
		setter_2 = 0;
		setter_3 = 0;
		setter_4 = 0;
		setter_5 = 0;
		setter_6 = 0;
		setter_7 = 0;
		setter_8 = 0;
		setter_9 = 0;
		setter_10 = 0;
		setter_11 = 0;
		setter_12 = 0;
		MULTIPLIER = 3.33;

		var month  = _returnMonth();
		//var progress = 0;
		var userid = <?php echo $id;?>;
		
		$.ajax({
      		url: "/platform/GetSheetData",
      		type: "POST",
      		data:{userid:userid},
      		success: function(response) {
	      		switch(response) {
	      			case "No Id":
	      				console.log("No user id found!");
	      			break;
	      			case "No Data Related To user id":
	      				console.log("No Data Related To user id!");
	      			break;
	      			case "No Data in spread sheet":
	      				console.log("No Data in spread sheet!");
	      			break;
	      			default:
	      				var response = $.parseJSON(response);
	      				//console.log(response);
	      				//return;
	      				if (response.length > 0) {

		      				for(var i =0; i < response.length; i++){
		      					_showTableData(response[i].update_date.split('-')[1], response[i]);
				      		}
	      				} else {
	      					console.log("Some internal error occured! debug defult case");
	      				}
	      				_setProgressBar();
	      			break;
	      		}
      		}
      	});

	});
	function _returnMonth() {
		var month = moment().month();
		month = month+1;
		//console.log(month);
		switch(month) {
			case 1:
				$('#tab_jan').parent().attr('style','border:5px solid #00acb3;');
				return 1;
			break;
			case 2:
				$('#tab_feb').parent().attr('style','border:5px solid #00acb3;');
				return 2;
			break;
			case 3:
				$('#tab_mar').parent().attr('style','border:5px solid #00acb3;');
				return 3;
			break;
			case 4:
				$('#tab_apr').parent().attr('style','border:5px solid #00acb3;');
				return 4;
			break;
			case 5:
				$('#tab_may').parent().attr('style','border:5px solid #00acb3;');
				return 5;
			break;
			case 6:
				$('#tab_jun').parent().attr('style','border:5px solid #00acb3;');
				return 6;
			break;
			case 7:
				$('#tab_july').parent().attr('style','border:5px solid #00acb3;');
				return 7;
			break;
			case 8:
				$('#tab_aug').parent().attr('style','border:5px solid #00acb3;');
				return 8;
			break;
			case 9:
				$('#tab_sep').parent().attr('style','border:5px solid #00acb3;');
				return 9;
			break;
			case 10:
				$('#tab_oct').parent().attr('style','border:5px solid #00acb3;');
				return 10;
			break;
			case 11:
				$('#tab_nov').parent().attr('style','border:5px solid #00acb3;');
				return 11;
			break;
			case 12:
				$('#tab_dec').parent().attr('style','border:5px solid #00acb3;');
				return 12;
			break;
			default:
				console.log('Error in selecting the month debug in return month');
			break;
		}
	}
	
	function _showTableData(month, response) {
		var month = parseInt(month);
		var task_one_jq = "";
		var task_two_jq = "";
		task_one_jq = response.task_one;
		task_one_jq = task_one_jq == 1 ? "DONE" : "Pending or rejected";
		task_two_jq = response.task_two;
		task_two_jq = task_two_jq == 1 ? "DONE" : "Pending or rejected";
		switch(month) {
			case 1:
			if (response.modarator_comment_task_one == '3.33 % Earned' && response.task_one == "1") {
				
				setter_1++;
				
			}
			if (response.modarator_comment_task_two == '3.33 % Earned' && response.task_two == "1") {
				setter_1++;
				
			}
			$('#tab_jan #show_data').append('<tr><td>'+response.update_date+'</td><td>'+moment(moment(new Date(moment(response.update_date, "DD-MM-YYYY"))).subtract(29, 'days') ).format("DD-MM-YYYY")+" UTC TO "+response.update_date+" UTC"+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 2:
				if (response.modarator_comment_task_one == '3.33 % Earned' && response.task_one == "1") {
					setter_2++;
				}
				if (response.modarator_comment_task_two == '3.33 % Earned' && response.task_two == "1") {
					setter_2++;
				}
				$('#tab_feb #show_data').append('<tr><td>'+response.update_date+'</td><td>'+moment(moment(new Date(moment(response.update_date, "DD-MM-YYYY"))).subtract(29, 'days') ).format("DD-MM-YYYY")+" UTC TO "+response.update_date+" UTC"+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 3:
				if (response.modarator_comment_task_one == '3.33 % Earned' && response.task_one == "1") {
					setter_3++;
				}
				if (response.modarator_comment_task_two == '3.33 % Earned' && response.task_two == "1") {
					setter_3++;
				}
				$('#tab_mar #show_data').append('<tr><td>'+response.update_date+'</td><td>'+moment(moment(new Date(moment(response.update_date, "DD-MM-YYYY"))).subtract(29, 'days') ).format("DD-MM-YYYY")+" UTC TO "+response.update_date+" UTC"+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 4:
				if (response.modarator_comment_task_one == '3.33 % Earned' && response.task_one == "1") {
					setter_4++;
				}
				if (response.modarator_comment_task_two == '3.33 % Earned' && response.task_two == "1") {
					setter_4++;
				}
				$('#tab_apr #show_data').append('<tr><td>'+response.update_date+'</td><td>'+moment(moment(new Date(moment(response.update_date, "DD-MM-YYYY"))).subtract(29, 'days') ).format("DD-MM-YYYY")+" UTC TO "+response.update_date+" UTC"+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 5:
				if (response.modarator_comment_task_one == '3.33 % Earned' && response.task_one == "1") {
					setter_5++;
				}
				if (response.modarator_comment_task_two == '3.33 % Earned' && response.task_two == "1") {
					setter_5++;
				}
				$('#tab_may #show_data').append('<tr><td>'+response.update_date+'</td><td>'+moment(moment(new Date(moment(response.update_date, "DD-MM-YYYY"))).subtract(29, 'days') ).format("DD-MM-YYYY")+" UTC TO "+response.update_date+" UTC"+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 6:
				if (response.modarator_comment_task_one == '3.33 % Earned' && response.task_one == "1") {
					setter_6++;
				}
				if (response.modarator_comment_task_two == '3.33 % Earned' && response.task_two == "1") {
					setter_6++;
				}
				$('#tab_jun #show_data').append('<tr><td>'+response.update_date+'</td><td>'+moment(moment(new Date(moment(response.update_date, "DD-MM-YYYY"))).subtract(29, 'days') ).format("DD-MM-YYYY")+" UTC TO "+response.update_date+" UTC"+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 7:
				if (response.modarator_comment_task_one == '3.33 % Earned' && response.task_one == "1") {
					setter_7++;
				}
				if (response.modarator_comment_task_two == '3.33 % Earned' && response.task_two == "1") {
					setter_7++;
				}
				$('#tab_july #show_data').append('<tr><td>'+response.update_date+'</td><td>'+moment(moment(new Date(moment(response.update_date, "DD-MM-YYYY"))).subtract(29, 'days') ).format("DD-MM-YYYY")+" UTC TO "+response.update_date+" UTC"+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 8:
				if (response.modarator_comment_task_one == '3.33 % Earned' && response.task_one == "1") {
					setter_8++;
				}
				if (response.modarator_comment_task_two == '3.33 % Earned' && response.task_two == "1") {
					setter_8++;
				}
				$('#tab_aug #show_data').append('<tr><td>'+response.update_date+'</td><td>'+moment(moment(new Date(moment(response.update_date, "DD-MM-YYYY"))).subtract(29, 'days') ).format("DD-MM-YYYY")+" UTC TO "+response.update_date+" UTC"+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 9:
				if (response.modarator_comment_task_one == '3.33 % Earned' && response.task_one == "1") {
					setter_9++;
				}
				if (response.modarator_comment_task_two == '3.33 % Earned' && response.task_two == "1") {
					setter_9++;
				}
				$('#tab_sep #show_data').append('<tr><td>'+response.update_date+'</td><td>'+moment(moment(new Date(moment(response.update_date, "DD-MM-YYYY"))).subtract(29, 'days') ).format("DD-MM-YYYY")+" UTC TO "+response.update_date+" UTC"+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 10:
				if (response.modarator_comment_task_one == '3.33 % Earned' && response.task_one == "1") {
					setter_10++;
				}
				if (response.modarator_comment_task_two == '3.33 % Earned' && response.task_two == "1") {
					setter_10++;
				}
				$('#tab_oct #show_data').append('<tr><td>'+response.update_date+'</td><td>'+moment(moment(new Date(moment(response.update_date, "DD-MM-YYYY"))).subtract(29, 'days') ).format("DD-MM-YYYY")+" UTC TO "+response.update_date+" UTC"+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 11:
				if (response.modarator_comment_task_one == '3.33 % Earned' && response.task_one == "1") {
					setter_11++;
				}
				if (response.modarator_comment_task_two == '3.33 % Earned' && response.task_two == "1") {
					setter_11++;
				}
				$('#tab_nov #show_data').append('<tr><td>'+response.update_date+'</td><td>'+moment(moment(new Date(moment(response.update_date, "DD-MM-YYYY"))).subtract(29, 'days') ).format("DD-MM-YYYY")+" UTC TO "+response.update_date+" UTC"+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			case 12:
				if (response.modarator_comment_task_one == '3.33 % Earned' && response.task_one == "1") {
					setter_12++;
					
				}
				if (response.modarator_comment_task_two == '3.33 % Earned' && response.task_two == "1") {
					setter_12++;
					
				}
				$('#tab_dec #show_data').append('<tr><td>'+response.update_date+'</td><td>'+moment(moment(new Date(moment(response.update_date, "DD-MM-YYYY"))).subtract(29, 'days') ).format("DD-MM-YYYY")+" UTC TO "+response.update_date+" UTC"+'</td><td>'+response.modarator_comment_task_one+'</td><td>'+task_two_jq+'</td><td>'+response.modarator_comment_task_two+'</td></tr>');
			break;
			default:
				console.log('Error in putting data');
			break;
		}

	}
	function _setProgressBar() {
		$('.progress .prog_jan').css("width",function(){
			$(this).attr("aria-valuenow", MULTIPLIER*setter_1.toFixed(2));
			$('.progress .prog_jan .val').html(MULTIPLIER*setter_1.toFixed(2)+"%");
			return $(this).attr("aria-valuenow") + "%";
		});
		$('.progress .prog_feb').css("width",function(){
			$(this).attr("aria-valuenow", MULTIPLIER*setter_2.toFixed(2));
			$('.progress .prog_feb .val').html(MULTIPLIER*setter_2.toFixed(2)+"%");
			return $(this).attr("aria-valuenow") + "%";
		});
		$('.progress .prog_mar').css("width",function(){
			$(this).attr("aria-valuenow", MULTIPLIER*setter_3.toFixed(2));
			$('.progress .prog_mar .val').html(MULTIPLIER*setter_3.toFixed(2)+"%");
			return $(this).attr("aria-valuenow") + "%";
		});
		$('.progress .prog_apr').css("width",function(){
			$(this).attr("aria-valuenow", MULTIPLIER*setter_4.toFixed(2));
			$('.progress .prog_apr .val').html(MULTIPLIER*setter_4.toFixed(2)+"%");
			return $(this).attr("aria-valuenow") + "%";
		});
		$('.progress .prog_may').css("width",function(){
			$(this).attr("aria-valuenow", MULTIPLIER*setter_5.toFixed(2));
			$('.progress .prog_may .val').html(MULTIPLIER*setter_5.toFixed(2)+"%");
			return $(this).attr("aria-valuenow") + "%";
		});
		$('.progress .prog_jun').css("width",function(){
			$(this).attr("aria-valuenow", MULTIPLIER*setter_6.toFixed(2));
			$('.progress .prog_jun .val').html(MULTIPLIER*setter_6.toFixed(2)+"%");
			return $(this).attr("aria-valuenow") + "%";
		});
		$('.progress .prog_jul').css("width",function(){
			$(this).attr("aria-valuenow", MULTIPLIER*setter_7.toFixed(2));
			$('.progress .prog_jul .val').html(MULTIPLIER*setter_7.toFixed(2)+"%");
			return $(this).attr("aria-valuenow") + "%";
		});
		$('.progress .prog_aug').css("width",function(){
			$(this).attr("aria-valuenow", MULTIPLIER*setter_8.toFixed(2));
			$('.progress .prog_aug .val').html(MULTIPLIER*setter_8.toFixed(2)+"%");
			return $(this).attr("aria-valuenow") + "%";
		});
		$('.progress .prog_sep').css("width",function(){
			$(this).attr("aria-valuenow", MULTIPLIER*setter_9.toFixed(2));
			$('.progress .prog_sep .val').html(MULTIPLIER*setter_9.toFixed(2)+"%");
			return $(this).attr("aria-valuenow") + "%";
		});
		$('.progress .prog_oct').css("width",function(){
			$(this).attr("aria-valuenow", MULTIPLIER*setter_10.toFixed(2));
			$('.progress .prog_oct .val').html(MULTIPLIER*setter_10.toFixed(2)+"%");
			return $(this).attr("aria-valuenow") + "%";
		});
		$('.progress .prog_nov').css("width",function(){
			$(this).attr("aria-valuenow", MULTIPLIER*setter_11.toFixed(2));
			$('.progress .prog_nov .val').html(MULTIPLIER*setter_11.toFixed(2)+"%");
			return $(this).attr("aria-valuenow") + "%";
		});
		$('.progress .prog_dec').css("width",function(){
			$(this).attr("aria-valuenow", MULTIPLIER*setter_12.toFixed(2));
			$('.progress .prog_dec .val').html(MULTIPLIER*setter_12.toFixed(2)+"%");
			return $(this).attr("aria-valuenow") + "%";
		});
	}
	/*function _convertDate(date) {
		if (typeof date == "undefined") {
			//console.log(date.toString());
			return;
		} else {
			console.log(date);
		}
    	
    }*/
</script>
